webpackJsonp([66],{wffB:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("+/Vv"),l=a("TKbA"),n=a("Pcuu"),s={engine:1,brake:2,light:3,applique:4,color:5},o={name:"basicMotor",components:{partsModal:i.default,ActionPermControl:n.a},props:{type:String},data:function(){return{total:0,dateTime:"",downloadLoading:!1,listLoading:!1,list:[],listQuery:{page:1,limit:20,sort:"add_time",order:"desc",name:void 0,model:void 0,type:void 0},dialogStatus:"create",motorDialogVisible:!1}},created:function(){this.getList()},methods:{getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.listLoading=!0,this.listQuery.type=s[this.type]||e,Object(l.c)(this.listQuery).then(function(e){t.list=e.data.data.items,t.total=e.data.data.total,t.listLoading=!1}).catch(function(){t.list=[],t.total=0,t.listLoading=!1})},handleDateChange:function(t){if(t){var e=t[0].getTime(),a=t[1].getTime();this.listQuery.startTime=e,this.listQuery.endTime=a}else this.listQuery.startTime=void 0,this.listQuery.endTime=void 0},handlePartsStatus:function(t){var e=this;Object(l.e)({id:t.id,status:!t.status}).then(function(a){e.$notify({title:"成功",message:(t.status?"下架":"上架")+"成功",type:"success",duration:2e3}),e.getList()}).catch(function(a){console.log(a),e.$notify({title:"失败",message:a.data?a.data.msg:(t.status?"下架":"上架")+"失败",type:"error",duration:2e3}),e.getList()})},handleCreate:function(){var t=this;this.motorDialogVisible=!0,this.dialogStatus="create",this.$nextTick(function(){t.$refs.motorModal.init()})},handleUpdate:function(t){var e=this;this.motorDialogVisible=!0,this.dialogStatus="update",this.$nextTick(function(){e.$refs.motorModal.init(t)})},handleDelete:function(t){var e=this;Object(l.b)(t.id).then(function(t){e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})}).catch(function(t){e.$notify({title:"失败",message:t.data?t.data.msg:"删除失败",type:"error",duration:2e3})}).finally(function(){e.getList()})},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleFilter:function(){this.listQuery.page=1,this.getList()},handleDownload:function(){var t=this;this.downloadLoading=!0,Promise.all([a.e(2),a.e(76)]).then(a.bind(null,"zWO4")).then(function(e){var a=[],i=[];"color"===t.type?(a=["编号","名称","匹配车型","价格","色号","状态"],i=["id","name","motorName","price","model","status"]):(a=["编号","名称","匹配车型","图片","价格","型号","状态"],i=["id","name","motorName","pic","price","model","status"]);var l=e.formatJson(i,t.list,"basicMotor");e.export_json_to_excel({header:a,data:l,filename:""}),t.downloadLoading=!1})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入名称"},model:{value:t.listQuery.name,callback:function(e){t.$set(t.listQuery,"name",e)},expression:"listQuery.name"}}),t._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"color"==t.type?"请输入色号":"请输入型号"},model:{value:t.listQuery.model,callback:function(e){t.$set(t.listQuery,"model",e)},expression:"listQuery.model"}}),t._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入价格"},model:{value:t.listQuery.price,callback:function(e){t.$set(t.listQuery,"price",e)},expression:"listQuery.price"}}),t._v(" "),a("el-date-picker",{staticClass:"filter-item-datetimerange",attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.handleDateChange},model:{value:t.dateTime,callback:function(e){t.dateTime=e},expression:"dateTime"}}),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("查找")]),t._v(" "),t.$checkPerm("create")?a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加")]):t._e(),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-download",loading:t.downloadLoading},on:{click:t.handleDownload}},[t._v("导出")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{size:"small",data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"编号",prop:"id"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"名称",prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"匹配车型",prop:"motorName"}}),t._v(" "),"color"!==t.type?a("el-table-column",{attrs:{align:"center",label:"图片",prop:"pic"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{attrs:{src:t.row.pic,width:"40"}})]}}])}):t._e(),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"价格",prop:"price"}}),t._v(" "),"color"===t.type?a("el-table-column",{attrs:{align:"center",label:"色号",prop:"model"}}):a("el-table-column",{attrs:{align:"center",label:"型号",prop:"model"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"状态",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n        "+t._s(e.row.status?"上架":"下架")+"\r\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"300","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("action-perm-control",{attrs:{hasPerm:t.$checkPerm("update","delete","putway")}},[t.$checkPerm("putway")?a("el-button",{attrs:{type:e.row.status?"warning":"primary",size:"mini"},on:{click:function(a){t.handlePartsStatus(e.row)}}},[t._v(t._s(e.row.status?"下架":"上架"))]):t._e(),t._v(" "),t.$checkPerm("update")?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.handleUpdate(e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),t.$checkPerm("delete")?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){t.handleDelete(e.row)}}},[t._v("删除")]):t._e()],1)]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),t.motorDialogVisible?a("parts-modal",{ref:"motorModal",attrs:{type:t.listQuery.type,dialogStatus:t.dialogStatus},on:{fetchList:function(e){t.getList()}}}):t._e()],1)},staticRenderFns:[]},c=a("VU/8")(o,r,!1,null,null,null);e.default=c.exports}});