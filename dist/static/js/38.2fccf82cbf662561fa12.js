webpackJsonp([38],{AXpd:function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},bUaw:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("Pcuu"),i=e("tU9i"),l=e("H8JJ"),s=e("2sWl"),r=e("Ty/O"),o={name:"FestivalActivity",components:{ActionPermControl:a.a,BaseTable:i.a,ActivityModal:s.default},mixins:[l.a],data:function(){return{dialogStatus:"",dialogFormVisible:!1,statusMap:{1:"即将开始",2:"正在进行",3:"已结束"}}},methods:{getList:function(){var n=this;this.listQuery.from=2,Object(r.d)(this.listQuery).then(function(t){n.list=t.data.data.items,n.total=t.data.data.total,n.listLoading=!1}).catch(function(){n.list=[],n.total=0,n.listLoading=!1})},handleCreate:function(){var n=this;this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){n.$refs.activityModal.init()})},handleUpdate:function(n){var t=this;this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.activityModal.init(n)})},handleDelete:function(n){var t=this;this.$confirm("此操作将永久删除该活动, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.c)(n.id).then(function(n){t.getList(),t.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})}).catch(function(n){t.$notify({title:"失败",message:n.data?n.data.msg:"删除失败",type:"error",duration:2e3})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleChangeStatus:function(n){var t=this;Object(r.a)({id:n.id,enabled:!n.enabled}).then(function(e){0===e.data.code?t.getList():t.$notify({title:"失败",message:e.data?e.data.msg:(n.enabled?"停用":"启用")+"失败",type:"error",duration:2e3})}).catch(function(e){t.$notify({title:"失败",message:e.data?e.data.msg:(n.enabled?"停用":"启用")+"失败",type:"error",duration:2e3})})}}},c={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"app-container calendar-list-container"},[e("div",{staticClass:"filter-container"},[e("el-form",{attrs:{inline:!0,"label-position":"right"}},[e("el-form-item",{attrs:{label:"活动名称"}},[e("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入活动名称"},model:{value:n.listQuery.title,callback:function(t){n.$set(n.listQuery,"title",t)},expression:"listQuery.title"}})],1),n._v(" "),e("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:n.handleFilter}},[n._v("查找")]),n._v(" "),e("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:n.handleCreate}},[n._v("添加")])],1)],1),n._v(" "),e("base-table",{attrs:{data:n.list,loading:n.listLoading,pageSize:n.listQuery.limit,currentPage:n.listQuery.page,total:n.total},on:{"size-change":n.handleSizeChange,"current-change":n.handleCurrentChange}},[e("el-table-column",{attrs:{align:"center",label:"活动名称",prop:"title"}}),n._v(" "),e("el-table-column",{attrs:{align:"center",label:"活动图片",prop:"picUrl"},scopedSlots:n._u([{key:"default",fn:function(n){return[e("img",{attrs:{src:n.row.picUrl,alt:"活动图片",width:"100%"}})]}}])}),n._v(" "),e("el-table-column",{attrs:{align:"center",label:"开始时间","min-width":"110",prop:"startTime"}}),n._v(" "),e("el-table-column",{attrs:{align:"center",label:"结束时间","min-width":"110",prop:"endTime"}}),n._v(" "),e("el-table-column",{attrs:{align:"center",label:"排序",prop:"sortOrder"}}),n._v(" "),e("el-table-column",{attrs:{align:"center",label:"状态",prop:"status"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n        "+n._s(n.statusMap[t.row.status])+"\n      ")]}}])}),n._v(" "),e("el-table-column",{attrs:{align:"center",label:"是否启用",prop:"enabled"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-tag",{attrs:{type:t.row.enabled?"success":"error"}},[n._v(n._s(t.row.enabled?"启用":"不启用"))])]}}])}),n._v(" "),e("el-table-column",{attrs:{align:"center",label:"操作",width:"300","class-name":"small-padding fixed-width"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("action-perm-control",{attrs:{hasPerm:n.$checkPerm("update","delete","change")}},[n.$checkPerm("change")?e("el-button",{attrs:{type:t.row.enabled?"warning":"success",size:"mini"},on:{click:function(e){n.handleChangeStatus(t.row)}}},[n._v(n._s(t.row.enabled?"停用":"启用"))]):n._e(),n._v(" "),n.$checkPerm("update")?e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){n.handleUpdate(t.row)}}},[n._v("编辑")]):n._e(),n._v(" "),n.$checkPerm("delete")?e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){n.handleDelete(t.row)}}},[n._v("删除")]):n._e()],1)]}}])})],1),n._v(" "),n.dialogFormVisible?e("activity-modal",{ref:"activityModal",attrs:{dialogStatus:n.dialogStatus,from:2},on:{fetchList:function(t){n.getList()}}}):n._e()],1)},staticRenderFns:[]};var d=e("VU/8")(o,c,!1,function(n){e("cJ1K")},null,null);t.default=d.exports},cJ1K:function(n,t,e){var a=e("AXpd");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);e("rjj0")("077bd666",a,!0)}});