webpackJsonp([42],{"8sds":function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.required-prefix[data-v-3c413e24]:before{\r\n  content: '*';\r\n  color: #f56c6c;\r\n  margin-right: 5px;\n}\r\n",""])},fgCa:function(t,e,i){var o=i("8sds");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i("rjj0")("3e8feb57",o,!0)},sLIJ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("mvHQ"),r=i.n(o),s=i("Mg5x"),c={name:"SpecAndProduct",props:{uploadPath:String,downloadPath:String,token:String,specInfo:Array,proInfo:Array},data:function(){return{specRules:s.e,productRules:s.d,specifications:this.spec,specForm:{specification:"",value:""},specVisiable:!1,products:this.pro,productForm:{id:0,specifications:[],price:0,number:0,url:""},productVisiable:!1}},watch:{specInfo:function(t){this.specifications=t},proInfo:function(t){this.products=t},specifications:function(t){this.$emit("update-spec",t)},products:function(t){this.$emit("update-product",t)}},methods:{uploadProductUrl:function(t){this.productForm.url=this.downloadPath+"/"+t.key},handleSpecificationShow:function(){var t=this;this.specForm={specification:"",value:""},this.specVisiable=!0,this.$nextTick(function(){t.$refs.specForm.clearValidate()})},handleSpecificationAdd:function(){var t=this;this.$refs.specForm.validate(function(e){if(e){for(var i=t.specifications.length-1,o=0;o<t.specifications.length;o++){t.specifications[o].specification===t.specForm.specification&&(i=o)}t.specifications.splice(i+1,0,t.specForm),t.specVisiable=!1,t.specToProduct()}})},handleSpecificationDelete:function(t){var e=this.specifications.indexOf(t);this.specifications.splice(e,1),this.specToProduct()},specToProduct:function(){if(0!==this.specifications.length){var t=[],e=this.specifications[0].specification,i=[];i.push(0);for(var o=1;o<this.specifications.length;o++){var r=this.specifications[o].specification;r===e?i.push(o):(t.push(i),e=r,(i=[]).push(o))}t.push(i);for(var s=0,c=[],a=[],l=t.length,n=0;n<l;n++)a[n]=0;var p=0,u=!1;do{for(var d=[],f=this.products[s]?this.products[s].id:null,m=0;m<l;m++){var v=t[m][a[m]];d.push(this.specifications[v].value)}c[s]={id:f,key:s,specifications:d,price:0,skuNo:0,number:0,url:""},s++,p++,a[l-1]=p;for(var h=l-1;h>=0;h--)a[h]>=t[h].length&&(a[h]=0,p=0,h-1>=0&&(a[h-1]=a[h-1]+1));u=!1;for(var b=0;b<l;b++)0!==a[b]&&(u=!0)}while(u);this.products=c}else this.products=[]},handleProductShow:function(t){var e=this;this.productForm=JSON.parse(r()(t)),this.productVisiable=!0,this.$nextTick(function(){e.$refs.productForm.clearValidate()})},handleProductEdit:function(){var t=this;this.$refs.productForm.validate(function(e){if(e){for(var i=0;i<t.products.length;i++){var o=t.products[i];if(void 0!==o.id&&null!==o.id&&o.id===t.productForm.id){t.products.splice(i,1,t.productForm);break}if(void 0!==o.key&&null!==o.key&&o.key===t.productForm.key){t.products.splice(i,1,t.productForm);break}}t.productVisiable=!1}})}}},a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-card",{staticClass:"box-card"},[i("h3",{staticClass:"required-prefix"},[t._v("商品规格")]),t._v(" "),i("el-button",{attrs:{plain:!0,type:"primary"},on:{click:t.handleSpecificationShow}},[t._v("添加")]),t._v(" "),i("el-table",{attrs:{data:t.specifications}},[i("el-table-column",{attrs:{property:"specification",label:"规格名"}}),t._v(" "),i("el-table-column",{attrs:{property:"value",label:"规格值"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",{attrs:{type:"primary"}},[t._v("\r\n            "+t._s(e.row.value)+"\r\n          ")])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"250","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){t.handleSpecificationDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("el-dialog",{attrs:{title:"设置规格",visible:t.specVisiable},on:{"update:visible":function(e){t.specVisiable=e}}},[i("el-form",{ref:"specForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:t.specRules,model:t.specForm,"status-icon":"","label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"规格名",prop:"specification"}},[i("el-input",{model:{value:t.specForm.specification,callback:function(e){t.$set(t.specForm,"specification",e)},expression:"specForm.specification"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"规格值",prop:"value"}},[i("el-input",{model:{value:t.specForm.value,callback:function(e){t.$set(t.specForm,"value",e)},expression:"specForm.value"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.specVisiable=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleSpecificationAdd}},[t._v("确定")])],1)],1)],1),t._v(" "),i("el-card",{staticClass:"box-card"},[i("h3",{staticClass:"required-prefix"},[t._v("商品库存")]),t._v(" "),i("el-table",{attrs:{data:t.products,"row-key":"key"}},[i("el-table-column",{attrs:{property:"value",label:"货品规格"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.specifications,function(e,o){return i("el-tag",{key:o},[t._v("\r\n            "+t._s(e)+"\r\n          ")])})}}])}),t._v(" "),i("el-table-column",{attrs:{property:"skuNo",width:"100",label:"SKU编码"}}),t._v(" "),i("el-table-column",{attrs:{property:"price",width:"100",label:"货品售价"}}),t._v(" "),i("el-table-column",{attrs:{property:"number",width:"100",label:"货品数量"}}),t._v(" "),i("el-table-column",{attrs:{property:"url",width:"100",label:"货品图片"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.url?i("img",{attrs:{src:e.row.url,width:"40"}}):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"100","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){t.handleProductShow(e.row)}}},[t._v("设置")])]}}])})],1),t._v(" "),i("el-dialog",{attrs:{title:"设置货品",visible:t.productVisiable},on:{"update:visible":function(e){t.productVisiable=e}}},[i("el-form",{ref:"productForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:t.productRules,model:t.productForm,"status-icon":"","label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"货品规格列",prop:"specifications"}},t._l(t.productForm.specifications,function(e,o){return i("el-tag",{key:o},[t._v("\r\n            "+t._s(e)+"\r\n          ")])})),t._v(" "),i("el-form-item",{attrs:{label:"货品售价",prop:"price"}},[i("el-input",{model:{value:t.productForm.price,callback:function(e){t.$set(t.productForm,"price",e)},expression:"productForm.price"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"货品数量",prop:"number"}},[i("el-input",{model:{value:t.productForm.number,callback:function(e){t.$set(t.productForm,"number",e)},expression:"productForm.number"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"SKU编码",prop:"skuNo"}},[i("el-input",{model:{value:t.productForm.skuNo,callback:function(e){t.$set(t.productForm,"skuNo",e)},expression:"productForm.skuNo"}})],1),t._v(" "),i("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"货品图片",prop:"url"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadPath,"list-type":"picture-card","show-file-list":!1,accept:".jpg,.jpeg,.png,.gif","on-success":t.uploadProductUrl}},[t.productForm.url?i("img",{staticClass:"avatar",attrs:{src:t.productForm.url}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t._v(" "),i("span",{staticClass:"pic-notice"},[t._v("建议上传375px*375px尺寸图片，货品图片最多上传1张")])],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.productVisiable=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleProductEdit}},[t._v("确定")])],1)],1)],1)],1)},staticRenderFns:[]};var l=i("VU/8")(c,a,!1,function(t){i("fgCa")},"data-v-3c413e24",null);e.default=l.exports}});