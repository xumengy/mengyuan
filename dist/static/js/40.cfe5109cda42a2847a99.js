webpackJsonp([40],{"+qOd":function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.edit-view img{\n  width: 100%;\n  display: block;\n}\n.table-expand {\n  font-size: 0;\n}\n.table-expand label {\n  width: 100px;\n  color: #99a9bf;\n}\n.table-expand .el-form-item {\n  margin-right: 0;\n  margin-bottom: 0;\n}\n.gallery {\n  width: 80px;\n  margin-right: 10px;\n}\n",""])},BPMB:function(t,e,i){var a=i("+qOd");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("6f6a41ef",a,!0)},Dmc0:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("qsHl"),n=i("C7zZ"),l=i("1n3Z"),s=i("Pcuu"),o={name:"bargainList",components:{BackToTop:l.a,ActionPermControl:s.a},data:function(){return{list:[],total:0,listLoading:!0,categoryList:0,listQuery:{page:1,limit:20,goodsSn:void 0,name:void 0,categoryId:""},checkData:[],specifications:[],descDetail:"",descDialogVisible:!1,downloadLoading:!1,deleteLoading:!1,onSaleLoadingId:0,recommendLoadingId:0,listCategory:[]}},created:function(){this.getList(),this.getlistCategory()},methods:{getList:function(){var t=this;this.listLoading=!0,0===this.categoryList?(this.listQuery.type=0,this.listQuery.categoryId=""):(this.listQuery.type=0,this.listQuery.categoryId=this.categoryList),Object(n.e)(this.listQuery).then(function(e){t.list=e.data.data.items,t.total=e.data.data.total,t.listLoading=!1}).catch(function(){t.list=[],t.total=0,t.listLoading=!1})},getListNoLoading:function(t){var e=this;Object(n.e)(this.listQuery).then(function(i){e.list=i.data.data.items,e.total=i.data.data.total,t()}).catch(function(){e.list=[],e.total=0})},getlistCategory:function(){var t=this;Object(a.e)().then(function(e){var i=e.data;t.listCategory=i.data.categoryList})},onSaleLoading:function(t){return Number(this.onSaleLoadingId)===Number(t)},recommendLoading:function(t){return Number(this.recommendLoadingId)===Number(t)},handleTypeChange:function(){this.getList()},handleFilter:function(){this.listQuery.page=1,this.getList()},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleSelectionChange:function(t){this.checkData=t},handleShelf:function(t){var e=this;this.onSaleLoadingId=t.id,Object(n.g)({id:t.id,isOnSale:!t.isOnSale}).then(function(i){0===i.data.code?(e.$notify({title:"成功",message:(t.isOnSale?"下架":"上架")+"成功",type:"success",duration:2e3}),e.getListNoLoading(function(){e.onSaleLoadingId=0})):(e.$notify({title:"失败",message:"操作失败",type:"error",duration:2e3}),e.onSaleLoadingId=0)}).catch(function(t){e.$notify({title:"失败",message:t.data?t.data.msg:"操作失败",type:"error",duration:2e3}),e.onSaleLoadingId=0})},handleCreate:function(){this.$router.push({path:"/bargaingoods/create"})},handleUpdate:function(t){this.$router.push({path:"/bargaingoods/edit",query:{id:t.id,page:this.listQuery.page}})},showDesc:function(t){this.descDetail=t.detail,this.descDialogVisible=!0,this.specifications=t.items},handleMultipleDelete:function(){var t=this;if(this.deleteLoading=!0,this.checkData.length>0){var e=[];this.checkData.map(function(t){return e.push(t.id),t}),this.$confirm("此操作将批量删除所选商品, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.c)({ids:e.join(",")}).then(function(e){0===e.data.code?t.$notify({title:"成功",type:"success",message:"删除成功",duration:2e3}):t.$notify({title:"失败",message:"删除失败",type:"error",duration:2e3})}).catch(function(e){t.$notify({title:"失败",message:e.data?e.data.msg:"删除失败",type:"error",duration:2e3})}).finally(function(){t.getList()})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})}else this.$notify({title:"失败",message:"请选择要删除的项",type:"error",duration:1e3});this.deleteLoading=!1},handleDelete:function(t){var e=this;this.$confirm("此操作将删除所选商品, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.b)({goodsId:t.id}).then(function(t){e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3}),e.getList()})}).catch(function(){e.$message({type:"info",message:"已取消操作"})})}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container calendar-list-container"},[i("div",{staticClass:"filter-container"},[i("el-form",{attrs:{inline:!0,"label-position":"right","label-width":"90px"}},[i("el-form-item",{staticClass:"no-margin-bottom",attrs:{label:"商品编号："}},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入"},model:{value:t.listQuery.goodsSn,callback:function(e){t.$set(t.listQuery,"goodsSn",e)},expression:"listQuery.goodsSn"}})],1),t._v(" "),i("el-form-item",{staticClass:"no-margin-bottom",attrs:{label:"商品名称："}},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入"},model:{value:t.listQuery.name,callback:function(e){t.$set(t.listQuery,"name",e)},expression:"listQuery.name"}})],1),t._v(" "),i("el-form-item",{staticClass:"no-margin-bottom",attrs:{label:""}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"请选择商品列表"},on:{change:t.handleTypeChange},model:{value:t.categoryList,callback:function(e){t.categoryList=e},expression:"categoryList"}},[i("el-option",{attrs:{label:"全部商品",value:0}}),t._v(" "),t._l(t.listCategory,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})})],2)],1),t._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("查找")]),t._v(" "),t.$checkPerm("putway")?i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加")]):t._e(),t._v(" "),t.$checkPerm("delete")?i("el-button",{staticClass:"filter-item",attrs:{type:"danger",loading:t.deleteLoading,icon:"el-icon-delete"},on:{click:t.handleMultipleDelete}},[t._v("删除")]):t._e()],1)],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{size:"small",data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),i("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-form",{staticClass:"table-expand",attrs:{"label-position":"left"}},[i("el-form-item",{attrs:{label:"宣传画廊"}},t._l(e.row.gallery,function(t){return i("img",{key:t,staticClass:"gallery",attrs:{src:t}})})),t._v(" "),i("el-form-item",{attrs:{label:"商品介绍"}},[i("span",[t._v(t._s(e.row.brief))])]),t._v(" "),i("el-form-item",{attrs:{label:"商品单位"}},[i("span",[t._v(t._s(e.row.unit))])]),t._v(" "),i("el-form-item",{attrs:{label:"类目ID"}},[i("span",[t._v(t._s(e.row.categoryId))])])],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"商品编号",prop:"goodsSn"}}),t._v(" "),i("el-table-column",{attrs:{align:"center","min-width":"100",label:"商品名称",prop:"name"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",property:"iconUrl",label:"图片"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("img",{attrs:{src:t.row.picUrl,width:"40"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"总库存",prop:"productCount"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"详情",prop:"detail"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-dialog",{attrs:{title:"商品详情",visible:t.descDialogVisible},on:{"update:visible":function(e){t.descDialogVisible=e}}},[i("el-table",{attrs:{size:"small",data:t.specifications,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center","min-width":"100",label:"规格",prop:"specifications"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(e.row.specifications.join(","))+"\n              ")]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"库存",prop:"number"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"价格",prop:"price"}})],1),t._v(" "),i("div",{staticClass:"edit-view"},t._l(t.descDetail.split(","),function(t,e){return i("img",{key:e,attrs:{src:t,alt:""}})}))],1),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){t.showDesc(e.row)}}},[t._v("查看")])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"360","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("action-perm-control",{attrs:{hasPerm:t.$checkPerm("update","delete","putway","recomment")}},[t.$checkPerm("putway")?i("el-button",{attrs:{loading:t.onSaleLoading(e.row.id),type:e.row.isOnSale?"warning":"success",size:"mini"},on:{click:function(i){t.handleShelf(e.row)}}},[t._v(t._s(e.row.isOnSale?"下架":"上架"))]):t._e(),t._v(" "),t.$checkPerm("update")?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){t.handleUpdate(e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),t.$checkPerm("delete")?i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){t.handleDelete(e.row)}}},[t._v("删除")]):t._e()],1)]}}])})],1),t._v(" "),i("div",{staticClass:"pagination-container"},[i("el-pagination",{attrs:{background:"","current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-tooltip",{attrs:{placement:"top",content:"返回顶部"}},[i("back-to-top",{attrs:{visibilityHeight:100}})],1)],1)},staticRenderFns:[]};var c=i("VU/8")(o,r,!1,function(t){i("BPMB")},null,null);e.default=c.exports}});